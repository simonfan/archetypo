//     archetypo
//     (c) simonfan
//     archetypo is licensed under the MIT terms.

define("__archetypo/router/format",["require","exports","module","lodash"],function(e,t,r){function i(e){return e.replace(/(\(|\(.*:|:|\)|\*)/,"")}var o=(e("lodash"),/\((.*?)\)/g),n=/(\(\?)?:\w+/g,a=/\*\w+/g;r.exports=function(e,t){return e=e.replace(n,function(e){var r=i(e);return t[r]?t[r]:e}),e=e.replace(a,function(e){var r=i(e);return t[r]?t[r]:""}),e.replace(o,"")}}),define("__archetypo/router/index",["require","exports","module","lodash","lowercase-backbone","./format"],function(e,t,r){{var i=e("lodash"),o=e("lowercase-backbone").router,n=e("./format");r.exports=o.extend({initialize:function(){this.initializeArchRouter.apply(this,arguments)},initializeArchRouter:function(){this.routeFormats={}},route:function(e,t){return i.isString(t)&&(this.routeFormats[t]=e),o.prototype.route.apply(this,arguments)},navigate:function(e,t,r){var i=this.routeFormats[e];if(i){var a=n(i,t);return o.prototype.navigate.call(this,a,r)}return o.prototype.navigate.apply(this,arguments)}})}}),define("archetypo",["require","exports","module","lowercase-backbone","lodash","jquery","archetypo-view","./__archetypo/router/index"],function(e,t,r){var i=e("lowercase-backbone"),o=e("lodash"),n=e("jquery"),a=e("archetypo-view"),u=e("./__archetypo/router/index"),s=r.exports=a.extend(i.router.prototype).extend(u.prototype);s.proto({initialize:function(){this.initializeArchRouter.apply(this,arguments),this.initializeArchetypo.apply(this,arguments)},initializeArchetypo:function(){this.builders={"default":a}},builder:function(e,t){if(2===arguments.length)return o.isFunction(t)?this.builder[e]=t:o.isObject(t)&&(this.builder[e]=a.extend(t)),this.builders[e]=this.builders["default"].extend(t),this.builders[e];if(1===arguments.length){if(t=this.builders[e],!t)throw new Error('No builder "'+e+'" defined in app.');return t}},start:function(e){return e=e||{},e.app=this,e.el=e.el||n("[data-archetypo],[archetypo]"),i.view.prototype.initialize.apply(this,arguments),this.initializeArchetypoView(e),i.history.start(e),this}})});