//     archetypo
//     (c) simonfan
//     archetypo is licensed under the MIT terms.

define("__archetypo/view/sub-views",["require","exports","module","lodash","jquery"],function(t,e,r){var i=t("lodash"),o=t("jquery");r.exports=function(t,e){var r=e.find("[data-arch-view]");i.each(r,i.bind(function(e){var r=o(e),i=r.data(),n=t.constructor("view",i.archView);i.el=r,i.app=t,n(i)},this))}}),define("__archetypo/view/index",["require","exports","module","lodash","dockable-view","./sub-views"],function(t,e,r){{var i=t("lodash"),o=t("dockable-view"),n=t("./sub-views");r.exports=o.extend(function(t){this.$el=i.isObject(t.$el)?t.$el:t.el;var e=t.html||this.html;e&&this.$el.html(e);var r=t.app||this.app;n(r,this.$el);var a=this.$el.data("arch-id")||this.$el.prop("id")||this.cid;r.view(a,this),o.prototype.initialize.apply(this,arguments)})}}),define("__archetypo/router/format",["require","exports","module","lodash"],function(t,e,r){function i(t){return t.replace(/(\(|\(.*:|:|\)|\*)/,"")}var o=(t("lodash"),/\((.*?)\)/g),n=/(\(\?)?:\w+/g,a=/\*\w+/g;r.exports=function(t,e){return t=t.replace(n,function(t){var r=i(t);return e[r]?e[r]:t}),t=t.replace(a,function(t){var r=i(t);return e[r]?e[r]:""}),t.replace(o,"")}}),define("__archetypo/router/index",["require","exports","module","lodash","lowercase-backbone","./format"],function(t,e,r){{var i=t("lodash"),o=t("lowercase-backbone").router,n=t("./format");r.exports=o.extend({initialize:function(){this.routeFormats={}},route:function(t,e){return i.isString(e)&&(this.routeFormats[e]=t),o.prototype.route.apply(this,arguments)},navigate:function(t,e,r){var i=this.routeFormats[t];if(i){var a=n(i,e);return o.prototype.navigate.call(this,a,r)}return o.prototype.navigate.apply(this,arguments)}})}}),define("archetypo",["require","exports","module","subject","lowercase-backbone","q","lodash","./__archetypo/view/index","./__archetypo/router/index"],function(t,e,r){var i=(t("subject"),t("lowercase-backbone")),o=(t("q"),t("lodash")),n=t("./__archetypo/view/index"),a=t("./__archetypo/router/index"),s=r.exports=a.extend(function(){a.prototype.initialize.apply(this,arguments),this.constructors={view:{"default":n},model:{},collection:{}},this.instances={view:{},model:{},collection:{}}});s.proto({constructor:function(t,e,r){var i=this.constructors[t],n=i[e]||i["default"];return 3===arguments.length?(r.app=this,i[e]=n.extend(r),i[e]):2===arguments.length?(o.isObject(e)&&o.each(e,o.bind(this,function(e,r){this.constructor(t,r,e)})),n):void 0},instance:function(t,e,r){var i=this.instances[t]=this.instances[t]||{};return 3===arguments.length&&(i[e]=r),i[e]},build:function(t){var e=this.constructor("view","default");return e({$el:t,app:this}),this},start:function(t){return i.history.start(t),this}}),s.proto({view:o.partial(s.prototype.instance,"view"),model:o.partial(s.prototype.instance,"model"),collection:o.partial(s.prototype.instance,"collection")})});