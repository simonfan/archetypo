//     archetypo
//     (c) simonfan
//     archetypo is licensed under the MIT terms.

define("__archetypo/build-sub",["require","exports","module","lodash","jquery","q"],function(e,r,t){var n=e("lodash"),o=e("jquery"),u=e("q");t.exports=function(e,r){var t=e.find("[data-archetypo]"),i=n.map(t,function(e){o(e).archetypo(r)},this);return u.all(i)}}),define("__archetypo/load",["require","exports","module","lodash","q"],function(e,r,t){function n(e){return o.isString(e)?e.split(a):[]}var o=e("lodash"),u=e("q"),i=t.exports=function(r,t){var n=u.defer();return t=t||r,e(t,function(){n.resolve(o.zipObject(r,t))}),n.promise};i.properties=function(e,r){var t=e.data(),n=[],u=[];return o.each(r,function(e){o.isString(t[e])&&(n.push(e),u.push(u))}),_load(n,u)};var a=/\s+/;i.builders=function(e){var r=n(e.data("archetypo"));return i(r)}}),define("__archetypo/build-el",["require","exports","module","lodash","jquery","./build-sub","./load"],function(e,r,t){var n=e("lodash"),o=(e("jquery"),e("./build-sub")),u=e("./load");t.exports=function(e,r){var t=e.data("archetypo-done");if(!t){e.data("views",{});var i=[u.builders(e),u.modules(e,r.modules)];return q.spread(i).then(function(t,u){var i=n.extend({el:e},r,u),a=n.map(t,function(t){return q.when(t(i)).then(function(t){return e.data("views")[builderName]=t,o(e,r)})});return q.all(a)}).then(function(){return e})}return t}}),define("archetypo",["require","exports","module","lodash","jquery","./__archetypo/build-el"],function(e){var r=e("lodash"),t=e("jquery"),n=e("./__archetypo/build-el");t.prototype.archetypo=function(e){return n(this,e)},t.prototype.view=function(e){return this.data("views")[e]},t.prototype.subviews=function(e,n){var o=this.find(e);return r(o,function(e){return t(e).view(n)})}});